# code-purpose.md
なぜこのようなコードをするのかのまとめ

# MVCモデル
## 現在のディレクトリ構成の問題点
### 現在のディレクトリ構成
```sh
backend
├── Dockerfile
├── backend
├── db
│   └── database.go
├── go.mod
├── go.sum
├── handlers
│   ├── create_task.go
│   ├── get_tasks.go
│   ├── get_user.go
│   ├── get_user_task.go
│   ├── user_delete.go
│   ├── user_login.go
│   └── user_register.go
├── main.go
├── models
│   ├── task.go
│   └── user.go
├── router
│   └── router.go
└── supervisord.conf
```
### 機能：
- 新規登録: `user_register.go`
  - データを受け取りデータベースに保存
- ログイン: `user_login.go`
  - データを受け取りデータベースに保存
- 退会: `user_delete.go`
  - データベースのデータを削除
- タスクの投稿: `create_task.go`
  - データを受け取りデータベースに保存
- タスクの取得: `get_tasks.go`
  - データベースを取得
- あるユーザのタスクの取得: `get_user_task.go`
  - データを受け取りデータベースのデータを取得

### 問題点
- ファイルがどの部分のロジックを含んでいるかがわかりにくい。
- 全体的な構造に一貫性がない
- `handlers`フォルダに全てのプログラムが混在している
- どの部分がモデル、どの部分がデータ操作、どの部分がコントローラなのかわからない
- 今後新しい機能を追加する際に、どこにファイルを追加すべきか不明確になる

## MVCモデル
1. Model
   1. データベースやビジネスロジックに関する部分
   2. データの構造やデータベースとのやり取りを定義する
2. View
   1. UI/UX
   2. APIであれば、JSONレスポンスなどのレスポンス部分を定義する
3. Controller
   1. ユーザからリクエストデータを受け取り、ModelとViewにデータ渡す
   2. Modelにデータ処理の指示を出したり、Viewに画面表示の指示を出したり

## MVCモデルのディレクトリ構成
```sh
backend/
├── Dockerfile
├── db
│   └── database.go
├── go.mod
├── go.sum
├── controllers
│   ├── task_controller.go
│   ├── user_controller.go
├── main.go
├── models
│   ├── task.go
│   └── user.go
├── router
│   └── router.go
└── supervisord.conf
```
- `models`にデータベースとやりとりするプログラムを記載
  - `user.go`: 新しいユーザーをデータベースに追加, 指定されたIDのユーザーをデータベースから取得など
  - `task.go`: 新しいタスクをデータベースに追加, すべてのタスクをデータベースから取得, 指定されたユーザーIDのタスクをデータベースから取得など
- `controllers`にHTTPリクエストを処理するコントローラを記載
  - `task_controller.go`: ユーザー登録の処理, ユーザーログインの処理, ユーザー削除の処理など
  - `user_controller.go`: 新しいタスク作成リクエストの処理, タスク取得リクエストの処理, 指定されたユーザーのタスク取得リクエストの処理など


**今回はView層はReactで実装しているためバックエンドのディレクトリ構成にはView層は含まれていません！**

## メリット
- わかりやすくなる
  - コードの役割がはっきりしているため、どの部分が何をしているのかが分かりやすくなる！
  - 新しくプロジェクトに携わる人でもすぐに理解しやすい！
- 修正が簡単になる
  - 特定の機能を修正する時に、どこを直せば良いかがわかる！
  - データベースの処理を変更したい場合はモデルのコードを、リクエストの処理を変更したい場合はコントローラーのコードを修正すればいい！
- テストしやすくなる
  - 各部分の動作を個別にテストしやすくなる！
  - モデル、コントローラーそれぞれの動作を独立して確認できため、バグの発見や修正がスムーズに行える！

## まとめ
- Models
  - 役割: データベースとのやり取りを管理し、データの構造を定義する
  - 例: ユーザーの情報をデータベースに保存する、タスクの情報を取得する
- Controllers
  - 役割: HTTPリクエストを受け取り、適切なモデルを呼び出してデータベース操作を行い、レスポンスを返す
  - 例: ユーザーが新規登録するときの処理を行う、タスクを作成するリクエストを処理する
- View
  - 役割: ユーザーに表示するためのデータを整形する、WebアプリケーションではHTMLやJSONレスポンスなどを生成する
  - 例: ユーザー情報をJSON形式で返す、タスク一覧をHTML形式で表示する